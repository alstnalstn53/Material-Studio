<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aletheia</title>

<!-- ============================================
     THREE.JS & POST-PROCESSING LIBRARIES
     ============================================ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/LuminosityHighPassShader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

<!-- TODO: Firebase SDK (uncomment when ready)
<script src="https://www.gstatic.com/firebasejs/10.x.x/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.x.x/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.x.x/firebase-firestore-compat.js"></script>
-->

<!-- TODO: Stripe.js (uncomment when ready)
<script src="https://js.stripe.com/v3/"></script>
-->

<style>
/* ============================================
   0. RESET & BASE
   ============================================ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #fff;
  color: #111;
  font-family: "Helvetica Neue", Arial, sans-serif;
  line-height: 1.5;
  overflow: hidden;
  height: 100vh;
}

/* ============================================
   1. NAVIGATION
   ============================================ */
nav {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 98%;
  max-width: 1580px;
  height: 75px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 40px;
  z-index: 7000;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 6px;
  backdrop-filter: blur(6px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.02);
}

.logo {
  font-size: 19px;
  font-weight: 300;
  letter-spacing: -0.01em;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 10px;
  color: #000;
}

.logo svg {
  width: 26px;
  height: 26px;
  fill: none;
  stroke: #000;
  stroke-width: 1.5;
}

.nav-center {
  display: flex;
  gap: 40px;
  list-style: none;
  font-size: 14px;
}

.nav-center li {
  color: #555;
  cursor: pointer;
  padding: 4px 0;
  position: relative;
  transition: color 0.3s;
}

.nav-center li:hover { color: #000; }

.nav-center li.active {
  color: #000;
  font-weight: 500;
}

.nav-center li.active::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 100%;
  height: 1.5px;
  background: #000;
}

/* --- Auth Area (Right side of nav) --- */
.nav-auth {
  display: flex;
  align-items: center;
  gap: 12px;
}

.btn-signin {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 18px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  border-radius: 8px;
  background: transparent;
  font-size: 13px;
  font-weight: 400;
  color: #333;
  cursor: pointer;
  transition: all 0.25s;
  font-family: inherit;
}

.btn-signin:hover {
  background: rgba(0, 0, 0, 0.04);
  border-color: rgba(0, 0, 0, 0.2);
}

.btn-signin svg {
  width: 14px;
  height: 14px;
}

/* --- Profile Avatar (shown after login) --- */
.nav-profile {
  display: none;
  position: relative;
}

.nav-profile.show { display: flex; }

.profile-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: #000;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: box-shadow 0.2s;
  border: 2px solid transparent;
  overflow: hidden;
}

.profile-avatar:hover {
  box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.08);
}

.profile-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* --- Profile Dropdown --- */
.profile-dropdown {
  position: absolute;
  top: calc(100% + 12px);
  right: 0;
  width: 240px;
  background: #fff;
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 12px;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
  padding: 6px;
  display: none;
  z-index: 9999;
}

.profile-dropdown.show { display: block; }

.pd-user {
  padding: 14px 14px 12px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  margin-bottom: 4px;
}

.pd-name {
  font-size: 14px;
  font-weight: 500;
  color: #111;
}

.pd-email {
  font-size: 11px;
  color: #999;
  margin-top: 2px;
}

.pd-plan {
  display: inline-block;
  margin-top: 8px;
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.04em;
  background: rgba(0, 0, 0, 0.04);
  color: #666;
}

.pd-plan.pro {
  background: #000;
  color: #fff;
}

.pd-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-radius: 8px;
  font-size: 13px;
  color: #333;
  cursor: pointer;
  transition: background 0.15s;
}

.pd-item:hover { background: rgba(0, 0, 0, 0.03); }

.pd-item svg {
  width: 16px;
  height: 16px;
  stroke: #666;
  fill: none;
  stroke-width: 1.5;
  flex-shrink: 0;
}

.pd-divider {
  height: 1px;
  background: rgba(0, 0, 0, 0.05);
  margin: 4px 8px;
}

.pd-item.danger { color: #c44; }
.pd-item.danger svg { stroke: #c44; }

/* ============================================
   2. LOBBY (HERO SECTION)
   ============================================ */
.lobby {
  width: 100%;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

#canvas-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
}

.hero-text {
  text-align: center;
  z-index: 10;
  pointer-events: none;
}

.hero-sub {
  font-size: 20px;
  font-weight: 600;
  letter-spacing: 0.05em;
  opacity: 0;
  transition: 2s;
  margin-bottom: 280px;
}

.hero-main {
  font-size: clamp(100px, 10vw, 200px);
  font-weight: 580;
  letter-spacing: -0.03em;
  opacity: 0;
  transition: 2.5s;
}

.hero-sub.show,
.hero-main.show {
  opacity: 0.85;
}

.lobby-hint {
  position: absolute;
  bottom: 50px;
  font-size: 12px;
  color: #bbb;
  letter-spacing: 0.1em;
  opacity: 0;
  animation: fadeIn 1s 4s forwards;
}

/* ============================================
   3. ROOM (OVERLAY PANELS)
   ============================================ */
.room {
  position: fixed;
  inset: 0;
  z-index: 6000;
  background: rgba(250, 250, 250, 0.55);
  backdrop-filter: blur(50px) saturate(1.15);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.6s;
  display: flex;
  flex-direction: column;
}

.room.open {
  opacity: 1;
  pointer-events: all;
}

.room-content {
  flex: 1;
  overflow-y: auto;
  padding: 130px 0 140px;
  display: flex;
  justify-content: center;
  transition: filter 0.4s;
}

.room-content.blurred {
  filter: none !important;
  pointer-events: auto !important;
}

.room-content::-webkit-scrollbar { width: 3px; }
.room-content::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.06); border-radius: 3px; }

.room-inner {
  width: 100%;
  max-width: 900px;
  padding: 0 40px;
}

.room-label {
  font-family: "Courier New", monospace;
  font-size: 10px;
  font-weight: 600;
  color: #aaa;
  letter-spacing: 0.12em;
  margin-bottom: 50px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.room-label::before {
  content: '';
  width: 24px;
  height: 1px;
  background: #ccc;
}

.room-title {
  font-size: clamp(36px, 4.5vw, 64px);
  font-weight: 200;
  letter-spacing: -0.02em;
  margin-bottom: 50px;
  line-height: 1.2;
}

/* --- Philosophy --- */
.phi-text {
  font-size: 24px;
  font-weight: 300;
  line-height: 1.65;
  margin-bottom: 40px;
  word-break: keep-all;
}

.phi-desc {
  font-size: 15px;
  color: #555;
  line-height: 1.8;
  font-weight: 300;
  word-break: keep-all;
}

/* --- Method --- */
.method-row {
  display: flex;
  justify-content: space-between;
  padding: 60px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.method-row:last-child { border-bottom: none; }

.method-left { width: 40%; padding-top: 10px; }

.m-num {
  font-size: 12px;
  font-weight: 600;
  color: #999;
  margin-bottom: 20px;
  letter-spacing: 0.05em;
}

.m-desc {
  font-size: 15px;
  line-height: 1.6;
  color: #444;
  margin-bottom: 30px;
  font-weight: 300;
  word-break: keep-all;
}

.method-right { width: 55%; text-align: right; }

.big-typo {
  font-size: clamp(40px, 6vw, 90px);
  font-weight: 300;
  line-height: 0.9;
  letter-spacing: -0.02em;
}

/* --- Archive --- */
.archive-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 24px;
}

.archive-card {
  height: 380px;
  background: #fafafa;
  padding: 28px;
  display: flex;
  flex-direction: column;
  border-radius: 4px;
  transition: transform 0.5s, box-shadow 0.5s;
}

.archive-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 30px 60px rgba(0, 0, 0, 0.05);
  background: #fff;
}

.arc-cat {
  display: inline-block;
  padding: 5px 10px;
  border: 1px solid #000;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  margin-bottom: 20px;
  width: fit-content;
  background: #fff;
  z-index: 5;
}

.arc-body {
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.arc-shield {
  position: absolute;
  inset: -10px;
  background: rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(8px);
  border-radius: 4px;
  z-index: 4;
  transition: 0.6s;
  border: 1px solid rgba(255, 255, 255, 0.5);
}

.archive-card:hover .arc-shield {
  opacity: 0;
  transform: scale(1.05);
  pointer-events: none;
}

.arc-name  { font-size: 24px; font-weight: 300; margin-bottom: 6px; }
.arc-sub   { font-size: 13px; color: #555; margin-bottom: 16px; }
.arc-desc  { font-size: 12px; color: #666; line-height: 1.6; margin-top: auto; word-break: keep-all; }

/* ============================================
   4. CHATBOX
   ============================================ */
.chatbox-wrap {
  position: fixed;
  left: 0; right: 0; bottom: 0;
  width: 100%;
  display: flex;
  justify-content: center;
  padding: 0 24px 20px;
  z-index: 9999;
  pointer-events: auto;
}

.room:not(.open) .chatbox { display: none !important; }
.room.open .chatbox        { display: flex !important; }

.chatbox {
  width: 100%;
  max-width: 680px;
  display: flex;
  flex-direction: column;
  height: 56px;
  overflow: hidden;
  border-radius: 18px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.72);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.10);
  transition:
    height 0.55s cubic-bezier(0.19, 1, 0.22, 1),
    background 0.40s,
    box-shadow 0.40s,
    border-color 0.40s;
  pointer-events: auto;
}

.chatbox.expanded {
  height: min(72vh, calc(100vh - 160px));
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 18px 70px rgba(0, 0, 0, 0.18);
  border-color: rgba(0, 0, 0, 0.14);
}

/* --- Collapsed Bar --- */
.cb-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 18px;
  min-height: 56px;
  height: 56px;
  cursor: pointer;
  flex-shrink: 0;
}

.cb-model {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: 11px;
  font-weight: 500;
  color: #999;
  padding: 3px 10px;
  border-radius: 6px;
  background: rgba(0, 0, 0, 0.04);
  cursor: pointer;
  transition: 0.2s;
  flex-shrink: 0;
}

.cb-model:hover { background: rgba(0, 0, 0, 0.07); color: #666; }
.cb-model .dot  { width: 5px; height: 5px; border-radius: 50%; }
.cb-model .arr  { width: 10px; height: 10px; stroke: currentColor; fill: none; stroke-width: 2; }

.cb-ph {
  flex: 1;
  font-size: 14px;
  color: #bbb;
  font-weight: 300;
  display: flex;
  align-items: center;
}

.cb-caret {
  display: inline-block;
  width: 1.5px;
  height: 15px;
  background: #999;
  margin-right: 4px;
  animation: blink 1.2s ease-in-out infinite;
}

.chatbox.expanded .cb-ph,
.chatbox.expanded .cb-caret { display: none; }

/* --- Expanded Body --- */
.cb-body {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  min-height: 0;
}

.cb-body,
.cb-messages,
.cb-scroll,
.cb-panel {
  max-height: calc(100% - 56px);
  overflow: auto;
}

.cb-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 18px 12px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.04);
  flex-shrink: 0;
}

.cb-header-left { display: flex; align-items: center; gap: 8px; }

.cb-header-logo {
  width: 22px;
  height: 22px;
  border-radius: 6px;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cb-header-logo svg { width: 11px; height: 11px; stroke: #fff; fill: none; stroke-width: 1.5; }
.cb-header-name     { font-size: 12px; font-weight: 500; color: #444; }

.cb-close {
  width: 28px;
  height: 28px;
  border-radius: 7px;
  border: none;
  background: rgba(0, 0, 0, 0.04);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: 0.15s;
}

.cb-close:hover { background: rgba(0, 0, 0, 0.08); }
.cb-close svg   { width: 12px; height: 12px; stroke: #888; fill: none; stroke-width: 2; }

/* --- Messages --- */
.cb-msgs {
  flex: 1;
  overflow-y: auto;
  padding: 16px 18px;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.cb-msgs::-webkit-scrollbar       { width: 3px; }
.cb-msgs::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.06); border-radius: 3px; }

.cb-welcome {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 30px 10px;
  flex: 1;
  justify-content: center;
}

.cb-welcome.hidden { display: none; }
.cb-welcome-t { font-size: 16px; font-weight: 300; color: #222; margin-bottom: 5px; }
.cb-welcome-s { font-size: 12px; color: #aaa; font-weight: 300; line-height: 1.5; max-width: 260px; }

.cb-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: center;
  margin-top: 18px;
}

.cb-chip {
  padding: 7px 14px;
  border-radius: 16px;
  font-size: 11px;
  color: #555;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(0, 0, 0, 0.05);
  cursor: pointer;
  transition: 0.25s;
}

.cb-chip:hover {
  background: #fff;
  border-color: rgba(0, 0, 0, 0.12);
  transform: translateY(-1px);
}

/* --- Message Bubbles --- */
.msg {
  display: flex;
  gap: 11px;
  animation: msgIn 0.4s ease;
}

.msg-ava {
  width: 26px;
  height: 26px;
  border-radius: 8px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 2px;
}

.msg-ava.ai            { background: #000; }
.msg-ava.ai svg        { width: 12px; height: 12px; stroke: #fff; fill: none; stroke-width: 1.5; }
.msg-ava.user          { background: rgba(0, 0, 0, 0.06); }
.msg-ava.user svg      { width: 12px; height: 12px; stroke: #555; fill: none; stroke-width: 1.5; }

.msg-body  { flex: 1; min-width: 0; }
.msg-role  { font-size: 10px; font-weight: 600; color: #bbb; margin-bottom: 4px; letter-spacing: 0.05em; }
.msg-text  { font-size: 13.5px; line-height: 1.75; color: #222; font-weight: 300; word-break: keep-all; }

.typing span {
  display: inline-block;
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: #ccc;
  margin-right: 4px;
  animation: tDot 1.4s ease infinite;
}

.typing span:nth-child(2) { animation-delay: 0.15s; }
.typing span:nth-child(3) { animation-delay: 0.3s; }

/* --- Input --- */
.cb-input {
  padding: 10px 16px 14px;
  border-top: 1px solid rgba(0, 0, 0, 0.03);
  flex-shrink: 0;
}

.cb-input-row {
  display: flex;
  align-items: flex-end;
  gap: 8px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(0, 0, 0, 0.06);
  border-radius: 14px;
  padding: 10px 12px;
  transition: 0.25s;
}

.cb-input-row:focus-within {
  border-color: rgba(0, 0, 0, 0.14);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
  background: rgba(255, 255, 255, 0.8);
}

.cb-ta {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  font-size: 14px;
  font-family: inherit;
  color: #111;
  resize: none;
  line-height: 1.5;
  max-height: 100px;
  min-height: 20px;
  font-weight: 300;
}

.cb-ta::placeholder { color: #bbb; }

.cb-send {
  width: 30px;
  height: 30px;
  border-radius: 10px;
  background: #000;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  opacity: 0.12;
  transition: 0.2s;
}

.cb-send.ready { opacity: 1; }
.cb-send svg   { width: 14px; height: 14px; stroke: #fff; fill: none; stroke-width: 2; }

/* ============================================
   5. MODEL SELECTOR DROPDOWN
   ============================================ */
#modelMenu {
  position: fixed;
  z-index: 99999;
  background: #fff;
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 10px;
  padding: 4px;
  min-width: 170px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  display: none;
  pointer-events: auto;
}

#modelMenu.show { display: block; }

.mm-opt {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 9px 12px;
  border-radius: 7px;
  font-size: 12px;
  color: #333;
  cursor: pointer;
  transition: background 0.15s;
}

.mm-opt:hover  { background: rgba(0, 0, 0, 0.04); }
.mm-opt.active { font-weight: 600; background: rgba(0, 0, 0, 0.04); }
.mm-opt .md    { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }

/* ============================================
   6. LOGIN MODAL
   ============================================ */
.modal-overlay {
  position: fixed;
  inset: 0;
  z-index: 50000;
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(8px);
  display: none;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.35s;
}

.modal-overlay.show {
  display: flex;
  opacity: 1;
}

.login-modal {
  width: 380px;
  max-width: 90vw;
  background: #fff;
  border-radius: 16px;
  padding: 48px 40px 40px;
  text-align: center;
  box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15);
  transform: translateY(20px);
  transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
}

.modal-overlay.show .login-modal {
  transform: translateY(0);
}

.login-logo {
  width: 40px;
  height: 40px;
  margin: 0 auto 24px;
}

.login-logo svg {
  width: 40px;
  height: 40px;
  stroke: #000;
  fill: none;
  stroke-width: 1.2;
}

.login-title {
  font-size: 22px;
  font-weight: 300;
  letter-spacing: -0.01em;
  margin-bottom: 8px;
}

.login-sub {
  font-size: 13px;
  color: #999;
  font-weight: 300;
  margin-bottom: 36px;
  line-height: 1.5;
}

.btn-google {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 14px 20px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 12px;
  background: #fff;
  font-size: 14px;
  font-weight: 400;
  color: #333;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
}

.btn-google:hover {
  background: #fafafa;
  border-color: rgba(0, 0, 0, 0.2);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
}

.btn-google svg { width: 18px; height: 18px; flex-shrink: 0; }

.login-terms {
  margin-top: 24px;
  font-size: 11px;
  color: #bbb;
  line-height: 1.6;
}

.login-terms a {
  color: #888;
  text-decoration: underline;
}

.login-close {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: rgba(0, 0, 0, 0.04);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: 0.15s;
}

.login-close:hover { background: rgba(0, 0, 0, 0.08); }
.login-close svg { width: 14px; height: 14px; stroke: #888; fill: none; stroke-width: 2; }

/* ============================================
   7. MY PAGE (ROOM)
   ============================================ */
.mypage-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 50px;
}

.mypage-card {
  background: #fafafa;
  border-radius: 12px;
  padding: 32px;
  border: 1px solid rgba(0, 0, 0, 0.04);
  transition: border-color 0.3s;
}

.mypage-card:hover {
  border-color: rgba(0, 0, 0, 0.1);
}

.mypage-card.full {
  grid-column: 1 / -1;
}

.mc-label {
  font-family: "Courier New", monospace;
  font-size: 10px;
  font-weight: 600;
  color: #aaa;
  letter-spacing: 0.1em;
  margin-bottom: 20px;
}

.mc-value {
  font-size: 28px;
  font-weight: 200;
  letter-spacing: -0.02em;
  margin-bottom: 6px;
}

.mc-sub {
  font-size: 13px;
  color: #888;
  font-weight: 300;
}

/* --- Subscription Card --- */
.sub-status {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 24px;
}

.sub-badge {
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 0.03em;
}

.sub-badge.free  { background: rgba(0, 0, 0, 0.05); color: #666; }
.sub-badge.pro   { background: #000; color: #fff; }

.sub-detail {
  font-size: 13px;
  color: #888;
  font-weight: 300;
}

.btn-upgrade {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 28px;
  border: 1px solid #000;
  border-radius: 10px;
  background: #000;
  color: #fff;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.25s;
  font-family: inherit;
}

.btn-upgrade:hover {
  background: #222;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.btn-manage {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 28px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  border-radius: 10px;
  background: transparent;
  color: #333;
  font-size: 13px;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.25s;
  font-family: inherit;
  margin-left: 10px;
}

.btn-manage:hover {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.2);
}

/* --- Payment History Table --- */
.pay-table {
  width: 100%;
  border-collapse: collapse;
}

.pay-table th {
  font-family: "Courier New", monospace;
  font-size: 10px;
  font-weight: 600;
  color: #aaa;
  letter-spacing: 0.08em;
  text-align: left;
  padding: 0 0 16px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.pay-table td {
  font-size: 13px;
  color: #444;
  font-weight: 300;
  padding: 14px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.03);
}

.pay-table .pay-status {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 10px;
  font-weight: 600;
}

.pay-status.paid    { background: rgba(0, 180, 100, 0.08); color: #0a7; }
.pay-status.pending { background: rgba(255, 180, 0, 0.08); color: #c90; }

.pay-empty {
  text-align: center;
  padding: 40px 0;
  font-size: 13px;
  color: #bbb;
  font-weight: 300;
}

/* --- Chat History --- */
.chat-history-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.03);
  cursor: pointer;
  transition: 0.2s;
}

.chat-history-item:hover { padding-left: 8px; }

.chi-room {
  font-family: "Courier New", monospace;
  font-size: 10px;
  font-weight: 600;
  color: #aaa;
  letter-spacing: 0.06em;
  margin-bottom: 4px;
}

.chi-preview {
  font-size: 13px;
  color: #333;
  font-weight: 300;
}

.chi-date {
  font-size: 11px;
  color: #bbb;
  flex-shrink: 0;
}

/* ============================================
   8. PRICING MODAL
   ============================================ */
.pricing-modal {
  width: 700px;
  max-width: 95vw;
  max-height: 85vh;
  background: #fff;
  border-radius: 16px;
  padding: 48px 40px 40px;
  box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15);
  transform: translateY(20px);
  transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
  overflow-y: auto;
  position: relative;
}

.modal-overlay.show .pricing-modal {
  transform: translateY(0);
}

.pricing-title {
  font-size: 28px;
  font-weight: 200;
  letter-spacing: -0.02em;
  text-align: center;
  margin-bottom: 8px;
}

.pricing-sub {
  text-align: center;
  font-size: 14px;
  color: #999;
  font-weight: 300;
  margin-bottom: 40px;
}

.pricing-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.price-card {
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 14px;
  padding: 32px 28px;
  transition: border-color 0.3s, box-shadow 0.3s;
}

.price-card:hover {
  border-color: rgba(0, 0, 0, 0.15);
}

.price-card.featured {
  border-color: #000;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
  position: relative;
}

.price-card.featured::before {
  content: 'RECOMMENDED';
  position: absolute;
  top: -10px;
  left: 28px;
  padding: 3px 12px;
  background: #000;
  color: #fff;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.08em;
  border-radius: 4px;
}

.pc-name {
  font-size: 18px;
  font-weight: 400;
  margin-bottom: 6px;
}

.pc-price {
  font-size: 36px;
  font-weight: 200;
  letter-spacing: -0.02em;
  margin-bottom: 4px;
}

.pc-price span {
  font-size: 14px;
  color: #999;
  font-weight: 300;
}

.pc-desc {
  font-size: 12px;
  color: #888;
  margin-bottom: 24px;
  font-weight: 300;
  line-height: 1.5;
}

.pc-features {
  list-style: none;
  margin-bottom: 28px;
}

.pc-features li {
  font-size: 13px;
  color: #444;
  font-weight: 300;
  padding: 6px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.pc-features li::before {
  content: '';
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: #000;
  flex-shrink: 0;
}

.btn-price {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.25s;
  font-family: inherit;
  text-align: center;
}

.btn-price.primary {
  background: #000;
  color: #fff;
  border: 1px solid #000;
}

.btn-price.primary:hover {
  background: #222;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.btn-price.secondary {
  background: transparent;
  color: #333;
  border: 1px solid rgba(0, 0, 0, 0.12);
}

.btn-price.secondary:hover {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.2);
}

/* ============================================
   9. ANIMATIONS
   ============================================ */
@keyframes fadeIn  { to { opacity: 1; } }
@keyframes blink   { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
@keyframes msgIn   { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
@keyframes tDot    { 0%, 80%, 100% { opacity: 0.2; transform: scale(0.8); } 40% { opacity: 1; transform: scale(1.1); } }

/* ============================================
   10. HAMBURGER BUTTON (hidden on desktop)
   ============================================ */
.hamburger {
  display: none;
  width: 40px;
  height: 40px;
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 8px;
  border-radius: 8px;
  transition: background 0.2s;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 5px;
}

.hamburger:hover { background: rgba(0, 0, 0, 0.04); }

.hamburger span {
  display: block;
  width: 18px;
  height: 1.5px;
  background: #333;
  border-radius: 2px;
  transition: all 0.3s;
  transform-origin: center;
}

.hamburger.active span:nth-child(1) {
  transform: rotate(45deg) translate(4.5px, 4.5px);
}
.hamburger.active span:nth-child(2) { opacity: 0; }
.hamburger.active span:nth-child(3) {
  transform: rotate(-45deg) translate(4.5px, -4.5px);
}

/* ============================================
   11. MOBILE DRAWER
   ============================================ */
.mobile-drawer-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 49000;
  background: rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(4px);
  opacity: 0;
  transition: opacity 0.35s;
}

.mobile-drawer-overlay.show { opacity: 1; }

.mobile-drawer {
  position: fixed;
  top: 0;
  right: 0;
  width: 300px;
  max-width: 85vw;
  height: 100vh;
  height: 100dvh;
  z-index: 49500;
  background: #fff;
  box-shadow: -10px 0 40px rgba(0, 0, 0, 0.1);
  transform: translateX(100%);
  transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overscroll-behavior: contain;
}

.mobile-drawer.open { transform: translateX(0); }

.drawer-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px 16px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  flex-shrink: 0;
}

.drawer-title {
  font-size: 17px;
  font-weight: 300;
  letter-spacing: -0.01em;
  color: #000;
}

.drawer-close {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: none;
  background: rgba(0, 0, 0, 0.04);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: 0.15s;
}

.drawer-close:hover { background: rgba(0, 0, 0, 0.08); }
.drawer-close svg   { width: 14px; height: 14px; stroke: #888; fill: none; stroke-width: 2; }

/* --- Drawer Navigation --- */
.drawer-nav {
  padding: 16px 12px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.drawer-nav-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 16px;
  border-radius: 10px;
  font-size: 14px;
  font-weight: 400;
  color: #555;
  letter-spacing: 0.02em;
  cursor: pointer;
  transition: all 0.2s;
}

.drawer-nav-item:hover,
.drawer-nav-item.active {
  background: rgba(0, 0, 0, 0.03);
}

.drawer-nav-item.active {
  color: #000;
  font-weight: 600;
}

.drawer-nav-item svg {
  width: 18px;
  height: 18px;
  stroke: #888;
  fill: none;
  stroke-width: 1.5;
  flex-shrink: 0;
}

.drawer-nav-item.active svg { stroke: #000; }

/* --- Drawer Auth (Sign in) --- */
.drawer-auth {
  padding: 16px 16px 12px;
}

.drawer-signin {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 13px 16px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 10px;
  background: transparent;
  font-size: 14px;
  font-weight: 400;
  color: #333;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
}

.drawer-signin:hover {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.18);
}

.drawer-signin svg {
  width: 16px;
  height: 16px;
}

/* --- Drawer User (logged-in) --- */
.drawer-user {
  display: none;
  padding: 20px 20px 16px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.drawer-user.show { display: flex; gap: 12px; align-items: center; }

.drawer-user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #000;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 500;
  flex-shrink: 0;
  overflow: hidden;
}

.drawer-user-avatar img { width: 100%; height: 100%; object-fit: cover; }
.drawer-user-info { flex: 1; min-width: 0; }

.drawer-user-name {
  font-size: 14px;
  font-weight: 500;
  color: #111;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.drawer-user-email {
  font-size: 11px;
  color: #999;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-top: 1px;
}

.drawer-user-badge {
  display: inline-block;
  margin-top: 6px;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.04em;
  background: rgba(0, 0, 0, 0.04);
  color: #666;
}

.drawer-user-badge.pro { background: #000; color: #fff; }

/* --- Drawer Account Items --- */
.drawer-account {
  padding: 8px 12px 16px;
}

.drawer-account-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  border-radius: 10px;
  font-size: 13px;
  color: #444;
  cursor: pointer;
  transition: background 0.15s;
}

.drawer-account-item:hover { background: rgba(0, 0, 0, 0.03); }

.drawer-account-item svg {
  width: 16px;
  height: 16px;
  stroke: #888;
  fill: none;
  stroke-width: 1.5;
  flex-shrink: 0;
}

.drawer-account-item.danger { color: #c44; }
.drawer-account-item.danger svg { stroke: #c44; }

/* ============================================
   12. RESPONSIVE — TABLET (≤ 900px)
   ============================================ */
@media (max-width: 900px) {
  .pricing-grid { grid-template-columns: 1fr; }
  .mypage-grid  { grid-template-columns: 1fr; }
  .method-right { width: 50%; }
  .big-typo     { font-size: clamp(36px, 5vw, 70px); }
  .archive-grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); }
}

/* ============================================
   13. RESPONSIVE — MOBILE (≤ 640px)
   ============================================ */
@media (max-width: 640px) {

  body { -webkit-text-size-adjust: 100%; }
  nav { top: 0; width: 100%; max-width: 100%; height: 56px; padding: 0 16px; border-radius: 0; border: none; border-bottom: 1px solid rgba(0, 0, 0, 0.05); background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
  .logo { font-size: 16px; gap: 8px; }
  .logo svg { width: 22px; height: 22px; }
  .nav-center { display: none !important; }
  .nav-auth   { display: none !important; }
  .hamburger  { display: flex; }
  .btn-mobile-toggle { display: none !important; }
  .hero-sub { font-size: 14px; margin-bottom: 200px; }
  .hero-main { font-size: clamp(56px, 14vw, 100px); font-weight: 550; }
  .lobby-hint { bottom: 30px; font-size: 10px; }
  .room-content { padding: 76px 0 120px; }
  .room-inner   { padding: 0 20px; }
  .room-label   { font-size: 9px; margin-bottom: 30px; }
  .room-title   { font-size: clamp(28px, 7vw, 42px); margin-bottom: 30px; }
  .phi-text { font-size: 18px; margin-bottom: 28px; }
  .phi-desc { font-size: 14px; line-height: 1.7; }
  .method-row { flex-direction: column; gap: 16px; padding: 36px 0; }
  .method-left, .method-right { width: 100%; }
  .method-right { text-align: left; }
  .m-num  { margin-bottom: 12px; }
  .m-desc { font-size: 14px; margin-bottom: 16px; }
  .big-typo { font-size: clamp(36px, 12vw, 60px); }
  .archive-grid { grid-template-columns: 1fr; gap: 16px; }
  .archive-card { height: auto; min-height: 280px; padding: 24px; }
  .arc-name { font-size: 20px; }
  .chatbox-wrap { padding: 0 10px 10px; }
  .chatbox { max-width: 100%; border-radius: 16px; }
  .chatbox.expanded { height: calc(100vh - 76px); height: calc(100dvh - 76px); border-radius: 16px 16px 0 0; }
  .cb-bar { padding: 12px 14px; min-height: 50px; height: 50px; }
  .cb-model { font-size: 10px; padding: 3px 8px; }
  .cb-ph    { font-size: 13px; }
  .cb-msgs  { padding: 12px 14px; gap: 14px; }
  .cb-welcome-t { font-size: 15px; }
  .cb-chips { gap: 5px; }
  .cb-chip  { font-size: 10px; padding: 6px 11px; }
  .msg-text { font-size: 13px; }
  .cb-input { padding: 8px 12px 12px; }
  .cb-input-row { padding: 8px 10px; border-radius: 12px; }
  .cb-ta    { font-size: 14px; }
  .cb-send  { width: 28px; height: 28px; border-radius: 8px; }
  .login-modal { width: calc(100% - 24px); max-width: 100%; padding: 36px 28px 32px; border-radius: 14px; }
  .login-title { font-size: 20px; }
  .login-sub   { font-size: 12px; margin-bottom: 28px; }
  .btn-google  { padding: 13px 16px; font-size: 14px; border-radius: 10px; }
  .pricing-modal { width: calc(100% - 16px); max-width: 100%; max-height: 90vh; max-height: 90dvh; padding: 36px 20px 32px; border-radius: 14px; }
  .pricing-title { font-size: 22px; }
  .pricing-sub   { font-size: 13px; margin-bottom: 28px; }
  .pricing-grid  { grid-template-columns: 1fr; gap: 16px; }
  .price-card    { padding: 24px 20px; }
  .pc-name  { font-size: 16px; }
  .pc-price { font-size: 30px; }
  .btn-price { padding: 13px; }
  .mypage-grid  { grid-template-columns: 1fr; gap: 16px; }
  .mypage-card  { padding: 24px 20px; }
  .mc-value     { font-size: 22px; }
  .mc-sub       { font-size: 12px; }
  .btn-upgrade, .btn-manage { padding: 11px 20px; font-size: 12px; }
  .btn-manage   { margin-left: 0; margin-top: 8px; }
  .pay-table th { font-size: 9px; }
  .pay-table td { font-size: 12px; padding: 10px 4px; }
  .chat-history-item { padding: 12px 0; }
  .chi-preview  { font-size: 12px; }
  #modelMenu { min-width: 150px; border-radius: 8px; }
  .mm-opt    { padding: 8px 10px; font-size: 11px; }
  .mobile-drawer { width: 280px; }
}

/* ============================================
   14. RESPONSIVE — VERY SMALL (≤ 380px)
   ============================================ */
@media (max-width: 380px) {
  .hero-main   { font-size: clamp(44px, 16vw, 64px); }
  .room-title  { font-size: 26px; }
  .big-typo    { font-size: 32px; }
  .pricing-modal { padding: 28px 16px 24px; }
  .mobile-drawer { width: 260px; }
}

/* ============================================
   15. MOBILE TOGGLE BUTTON
   ============================================ */
.btn-mobile-toggle {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 8px;
  background: transparent;
  font-size: 12px;
  font-weight: 400;
  color: #555;
  cursor: pointer;
  transition: all 0.25s;
  font-family: inherit;
  flex-shrink: 0;
}

.btn-mobile-toggle:hover {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.18);
}

.btn-mobile-toggle svg {
  width: 14px;
  height: 14px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.5;
}

.btn-mobile-toggle.active {
  background: #000;
  border-color: #000;
  color: #fff;
}

/* ============================================
   16. MOBILE-MODE (Toggle-based mobile layout)
   Mirrors the @media ≤640px rules, activated
   by adding .mobile-mode class to <body>
   ============================================ */
body.mobile-mode nav {
  top: 0; width: 100%; max-width: 100%; height: 56px;
  padding: 0 16px; border-radius: 0; border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
}
body.mobile-mode .logo { font-size: 16px; gap: 8px; }
body.mobile-mode .logo svg { width: 22px; height: 22px; }
body.mobile-mode .nav-center { display: none !important; }
body.mobile-mode .nav-auth > .btn-signin { display: none !important; }
body.mobile-mode .nav-auth > .nav-profile { display: none !important; }
body.mobile-mode .hamburger { display: flex; }

body.mobile-mode .hero-sub { font-size: 14px; margin-bottom: 200px; }
body.mobile-mode .hero-main { font-size: clamp(56px, 14vw, 100px); font-weight: 550; }
body.mobile-mode .lobby-hint { bottom: 30px; font-size: 10px; }

body.mobile-mode .room-content { padding: 76px 0 120px; }
body.mobile-mode .room-inner { padding: 0 20px; }
body.mobile-mode .room-label { font-size: 9px; margin-bottom: 30px; }
body.mobile-mode .room-title { font-size: 32px; margin-bottom: 30px; }

body.mobile-mode .phi-text { font-size: 18px; margin-bottom: 28px; }
body.mobile-mode .phi-desc { font-size: 14px; line-height: 1.7; }

body.mobile-mode .method-row { flex-direction: column; gap: 16px; padding: 36px 0; }
body.mobile-mode .method-left,
body.mobile-mode .method-right { width: 100%; }
body.mobile-mode .method-right { text-align: left; }
body.mobile-mode .m-num { margin-bottom: 12px; }
body.mobile-mode .m-desc { font-size: 14px; margin-bottom: 16px; }
body.mobile-mode .big-typo { font-size: 48px; }

body.mobile-mode .archive-grid { grid-template-columns: 1fr; gap: 16px; }
body.mobile-mode .archive-card { height: auto; min-height: 280px; padding: 24px; }
body.mobile-mode .arc-name { font-size: 20px; }

body.mobile-mode .chatbox-wrap { padding: 0 10px 10px; }
body.mobile-mode .chatbox { max-width: 100%; border-radius: 16px; }
body.mobile-mode .chatbox.expanded { height: calc(100vh - 76px); border-radius: 16px 16px 0 0; }
body.mobile-mode .cb-bar { padding: 12px 14px; min-height: 50px; height: 50px; }
body.mobile-mode .cb-model { font-size: 10px; padding: 3px 8px; }
body.mobile-mode .cb-ph { font-size: 13px; }
body.mobile-mode .cb-msgs { padding: 12px 14px; gap: 14px; }
body.mobile-mode .cb-welcome-t { font-size: 15px; }
body.mobile-mode .cb-chips { gap: 5px; }
body.mobile-mode .cb-chip { font-size: 10px; padding: 6px 11px; }
body.mobile-mode .msg-text { font-size: 13px; }
body.mobile-mode .cb-input { padding: 8px 12px 12px; }
body.mobile-mode .cb-input-row { padding: 8px 10px; border-radius: 12px; }
body.mobile-mode .cb-ta { font-size: 14px; }
body.mobile-mode .cb-send { width: 28px; height: 28px; border-radius: 8px; }

body.mobile-mode .login-modal { width: calc(100% - 24px); max-width: 100%; padding: 36px 28px 32px; border-radius: 14px; }
body.mobile-mode .login-title { font-size: 20px; }
body.mobile-mode .login-sub { font-size: 12px; margin-bottom: 28px; }
body.mobile-mode .btn-google { padding: 13px 16px; font-size: 14px; border-radius: 10px; }

body.mobile-mode .pricing-modal { width: calc(100% - 16px); max-width: 100%; max-height: 90vh; padding: 36px 20px 32px; border-radius: 14px; }
body.mobile-mode .pricing-title { font-size: 22px; }
body.mobile-mode .pricing-sub { font-size: 13px; margin-bottom: 28px; }
body.mobile-mode .pricing-grid { grid-template-columns: 1fr; gap: 16px; }
body.mobile-mode .price-card { padding: 24px 20px; }
body.mobile-mode .pc-name { font-size: 16px; }
body.mobile-mode .pc-price { font-size: 30px; }
body.mobile-mode .btn-price { padding: 13px; }

body.mobile-mode .mypage-grid { grid-template-columns: 1fr; gap: 16px; }
body.mobile-mode .mypage-card { padding: 24px 20px; }
body.mobile-mode .mc-value { font-size: 22px; }
body.mobile-mode .mc-sub { font-size: 12px; }
body.mobile-mode .btn-upgrade,
body.mobile-mode .btn-manage { padding: 11px 20px; font-size: 12px; }
body.mobile-mode .btn-manage { margin-left: 0; margin-top: 8px; }
body.mobile-mode .pay-table th { font-size: 9px; }
body.mobile-mode .pay-table td { font-size: 12px; padding: 10px 4px; }
body.mobile-mode .chat-history-item { padding: 12px 0; }
body.mobile-mode .chi-preview { font-size: 12px; }

body.mobile-mode #modelMenu { min-width: 150px; border-radius: 8px; }
body.mobile-mode .mm-opt { padding: 8px 10px; font-size: 11px; }
body.mobile-mode .mobile-drawer { width: 280px; }
</style>
</head>


<body>

<!-- ============================================
     NAVIGATION
     ============================================ -->
<nav>
  <div class="logo" id="logoBtn">
    <svg viewBox="0 0 24 24">
      <path d="M 5 19 A 10 10 0 1 1 19 19" fill="none" stroke-linecap="round"/>
      <circle cx="12" cy="12" r="2.5" fill="#000" stroke="none"/>
    </svg>
    Aletheia
  </div>

  <ul class="nav-center">
    <li data-room="philosophy">PHILOSOPHY</li>
    <li data-room="method">METHOD</li>
    <li data-room="archive">ARCHIVE</li>
  </ul>

  <!-- Mobile View Toggle (desktop only) -->
  <button class="btn-mobile-toggle" id="btnMobileToggle" title="모바일 보기">
    <svg viewBox="0 0 24 24"><rect x="7" y="2" width="10" height="20" rx="2"/><line x1="10" y1="18" x2="14" y2="18"/></svg>
    <span class="mobile-toggle-label">Mobile</span>
  </button>

  <!-- Auth Area -->
  <div class="nav-auth">
    <button class="btn-signin" id="btnSignIn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="8" r="4"/><path d="M4 21v-1a6 6 0 0 1 12 0v1"/></svg>
      <span>Sign in</span>
    </button>

    <div class="nav-profile" id="navProfile">
      <div class="profile-avatar" id="profileAvatar">
        <!-- Filled by JS: initial or photo -->
      </div>
      <div class="profile-dropdown" id="profileDropdown">
        <div class="pd-user">
          <div class="pd-name" id="pdName">—</div>
          <div class="pd-email" id="pdEmail">—</div>
          <div class="pd-plan" id="pdPlan">FREE</div>
        </div>
        <div class="pd-item" id="pdMypage">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 21v-1a6 6 0 0 1 12 0v1"/></svg>
          마이페이지
        </div>
        <div class="pd-item" id="pdPricing">
          <svg viewBox="0 0 24 24"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
          구독 관리
        </div>
        <div class="pd-item" id="pdHistory">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          결제 내역
        </div>
        <div class="pd-divider"></div>
        <div class="pd-item danger" id="pdLogout">
          <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
          로그아웃
        </div>
      </div>
    </div>
  </div>

  <!-- Hamburger (Mobile only) -->
  <button class="hamburger" id="hamburgerBtn">
    <span></span><span></span><span></span>
  </button>
</nav>


<!-- ============================================
     MOBILE DRAWER
     ============================================ -->
<div class="mobile-drawer-overlay" id="drawerOverlay"></div>
<div class="mobile-drawer" id="mobileDrawer">
  <div class="drawer-header">
    <div class="drawer-title">Aletheia</div>
    <button class="drawer-close" id="drawerClose">
      <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  </div>

  <!-- User info (shown when logged in) -->
  <div class="drawer-user" id="drawerUser">
    <div class="drawer-user-avatar" id="drawerAvatar"></div>
    <div class="drawer-user-info">
      <div class="drawer-user-name" id="drawerName">—</div>
      <div class="drawer-user-email" id="drawerEmail">—</div>
      <span class="drawer-user-badge" id="drawerBadge">FREE</span>
    </div>
  </div>

  <!-- Navigation -->
  <div class="drawer-nav">
    <div class="drawer-nav-item" data-room="philosophy">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l3 3"/></svg>
      PHILOSOPHY
    </div>
    <div class="drawer-nav-item" data-room="method">
      <svg viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
      METHOD
    </div>
    <div class="drawer-nav-item" data-room="archive">
      <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 3v18"/></svg>
      ARCHIVE
    </div>
  </div>

  <!-- Auth: sign in (shown when logged out) -->
  <div class="drawer-auth" id="drawerAuth">
    <button class="drawer-signin" id="drawerSignIn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="8" r="4"/><path d="M4 21v-1a6 6 0 0 1 12 0v1"/></svg>
      Sign in
    </button>
  </div>

  <!-- Account items (shown when logged in) -->
  <div class="drawer-account" id="drawerAccount" style="display:none;">
    <div class="drawer-account-item" id="drawerMypage">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 21v-1a6 6 0 0 1 12 0v1"/></svg>
      마이페이지
    </div>
    <div class="drawer-account-item" id="drawerPricing">
      <svg viewBox="0 0 24 24"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
      구독 관리
    </div>
    <div class="drawer-account-item" id="drawerPayHistory">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      결제 내역
    </div>
    <div class="drawer-account-item danger" id="drawerLogout">
      <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
      로그아웃
    </div>
  </div>
</div>


<!-- ============================================
     LOBBY (HERO)
     ============================================ -->
<div class="lobby">
  <div id="canvas-container"></div>
  <div class="hero-text">
    <div class="hero-sub" id="heroSub">정의</div>
    <div class="hero-main" id="heroMain">DEFINITION</div>
  </div>
  <div class="lobby-hint">SELECT A ROOM FROM THE MENU ABOVE</div>
</div>


<!-- ============================================
     ROOM 01 — PHILOSOPHY
     ============================================ -->
<div class="room" id="room-philosophy">
  <div class="room-content" data-room="philosophy">
    <div class="room-inner">
      <div class="room-label">ROOM 01 — PHILOSOPHY</div>
      <h1 class="room-title">당신의 이야기가<br>가장 강력한 물성이 될 때.</h1>
      <div class="phi-text">"재료가 가진 본래의 성질을 방해하지 않는 것."</div>
      <div class="phi-desc">
        우리는 외부에서 유행하는 아이템을 가져오는 것이 아니라, 당신 내면의 원초적인 경험과 성질을 추출하여 세상에 단 하나뿐인 비즈니스의 물성으로 치환합니다.
        <br><br>
        Aletheia(ἀλήθεια)는 그리스어로 '비은폐' — 감춰진 것을 드러냄을 의미합니다. 우리는 답을 주지 않습니다. 대신 올바른 질문의 구조를 함께 만들어갑니다.
        <br><br>
        덜어내는 과정에서 남는 것이 본질입니다.
      </div>
    </div>
  </div>
  <div class="chatbox-wrap"><div class="chatbox" data-room="philosophy">
    <div class="cb-body">
      <div class="cb-header"><div class="cb-header-left"><div class="cb-header-logo"><svg viewBox="0 0 24 24"><path d="M 5 19 A 10 10 0 1 1 19 19" stroke-linecap="round"/><circle cx="12" cy="12" r="2" fill="currentColor" stroke="none"/></svg></div><span class="cb-header-name" data-room="philosophy">Aletheia Core</span></div><button class="cb-close" data-room="philosophy"><svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></button></div>
      <div class="cb-msgs" data-room="philosophy"><div class="cb-welcome" data-room="philosophy"><div class="cb-welcome-t">철학에 대해 물어보세요</div><div class="cb-welcome-s">Aletheia의 본질 탐구 철학과 방향성을 함께 찾아갑니다.</div><div class="cb-chips"><span class="cb-chip" data-room="philosophy" data-q="Less but Better 철학이 뭔가요?">Less but Better</span><span class="cb-chip" data-room="philosophy" data-q="물성이란 무엇을 의미하나요?">물성이란?</span><span class="cb-chip" data-room="philosophy" data-q="기존 컨설팅과 뭐가 다른가요?">기존 컨설팅과의 차이</span></div></div></div>
      <div class="cb-input"><div class="cb-input-row"><textarea class="cb-ta" data-room="philosophy" placeholder="철학에 대해 질문하세요..." rows="1"></textarea><button class="cb-send" data-room="philosophy"><svg viewBox="0 0 24 24"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></button></div></div>
    </div>
    <div class="cb-bar" data-room="philosophy"><div class="cb-model" data-room="philosophy"><span class="dot" style="background:#000"></span><span class="model-name">Core</span><svg class="arr" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></div><span class="cb-ph"><span class="cb-caret"></span>철학에 대해 질문하세요...</span></div>
  </div></div>
</div>


<!-- ============================================
     ROOM 02 — METHOD
     ============================================ -->
<div class="room" id="room-method">
  <div class="room-content" data-room="method">
    <div class="room-inner">
      <div class="room-label">ROOM 02 — THE METHOD</div>
      <h1 class="room-title">네 가지 단계.</h1>
      <div class="method-row"><div class="method-left"><span class="m-num">/0.1</span><p class="m-desc"><strong>Unmasking</strong><br>사회적 페르소나를 덜어내고, 경험의 원형만을 드러냅니다.</p></div><div class="method-right"><div class="big-typo">UNMASK</div></div></div>
      <div class="method-row"><div class="method-left"><span class="m-num">/0.2</span><p class="m-desc"><strong>Interpretation</strong><br>브랜드가 스스로 말해온 관계를 해석하고, 선택 가능한 가능성을 엽니다.</p></div><div class="method-right"><div class="big-typo">INTERPRET</div></div></div>
      <div class="method-row"><div class="method-left"><span class="m-num">/0.3</span><p class="m-desc"><strong>Mapping</strong><br>전략을 제시하지 않고, 선택 가능한 지형을 구조화합니다.</p></div><div class="method-right"><div class="big-typo">MAP</div></div></div>
      <div class="method-row"><div class="method-left"><span class="m-num">/0.4</span><p class="m-desc"><strong>Co-Solving</strong><br>우리는 해결하지 않습니다. 다만 함께 탐구합니다.</p></div><div class="method-right"><div class="big-typo">CO-SOLVE</div></div></div>
    </div>
  </div>
  <div class="chatbox-wrap"><div class="chatbox" data-room="method">
    <div class="cb-body">
      <div class="cb-header"><div class="cb-header-left"><div class="cb-header-logo"><svg viewBox="0 0 24 24"><path d="M 5 19 A 10 10 0 1 1 19 19" stroke-linecap="round"/><circle cx="12" cy="12" r="2" fill="currentColor" stroke="none"/></svg></div><span class="cb-header-name" data-room="method">Aletheia Deep</span></div><button class="cb-close" data-room="method"><svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></button></div>
      <div class="cb-msgs" data-room="method"><div class="cb-welcome" data-room="method"><div class="cb-welcome-t">방법론을 탐구하세요</div><div class="cb-welcome-s">각 단계의 원리와 적용을 안내합니다.</div><div class="cb-chips"><span class="cb-chip" data-room="method" data-q="Unmask 단계는 어떻게 진행되나요?">Unmask 과정</span><span class="cb-chip" data-room="method" data-q="Co-Solve에서 함께 탐구한다는 건?">Co-Solve란?</span></div></div></div>
      <div class="cb-input"><div class="cb-input-row"><textarea class="cb-ta" data-room="method" placeholder="방법론에 대해 질문하세요..." rows="1"></textarea><button class="cb-send" data-room="method"><svg viewBox="0 0 24 24"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></button></div></div>
    </div>
    <div class="cb-bar" data-room="method"><div class="cb-model" data-room="method"><span class="dot" style="background:#444"></span><span class="model-name">Deep</span><svg class="arr" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></div><span class="cb-ph"><span class="cb-caret"></span>방법론에 대해 질문하세요...</span></div>
  </div></div>
</div>


<!-- ============================================
     ROOM 03 — ARCHIVE
     ============================================ -->
<div class="room" id="room-archive">
  <div class="room-content" data-room="archive">
    <div class="room-inner">
      <div class="room-label">ROOM 03 — SELECTED ARCHIVES</div>
      <h1 class="room-title">탐구의 기록.</h1>
      <div class="archive-grid">
        <div class="archive-card"><span class="arc-cat">Cafe & Bakery</span><div class="arc-body"><h3 class="arc-name">GYEOL</h3><div class="arc-sub">침묵의 서사</div><p class="arc-desc">불필요한 소음을 제거하고 재료 본연의 소리에 집중하는 베이커리.</p><div class="arc-shield"></div></div></div>
        <div class="archive-card"><span class="arc-cat">Space Design</span><div class="arc-body"><h3 class="arc-name">RAW CONCRETE</h3><div class="arc-sub">가공되지 않은 날것</div><p class="arc-desc">거친 콘크리트 텍스처를 그대로 살려 진정성을 투영.</p><div class="arc-shield"></div></div></div>
        <div class="archive-card"><span class="arc-cat">Fashion</span><div class="arc-body"><h3 class="arc-name">STRUCTURE 01</h3><div class="arc-sub">기능적 본질주의</div><p class="arc-desc">장식을 배제하고 옷의 구조와 기능에만 집중한 레이블.</p><div class="arc-shield"></div></div></div>
        <div class="archive-card"><span class="arc-cat">Fragrance</span><div class="arc-body"><h3 class="arc-name">DEEP SOIL</h3><div class="arc-sub">고향의 흙냄새</div><p class="arc-desc">원초적인 기억인 흙의 향기를 현대적으로 재해석.</p><div class="arc-shield"></div></div></div>
        <div class="archive-card"><span class="arc-cat">Exhibition</span><div class="arc-body"><h3 class="arc-name">THE VOID</h3><div class="arc-sub">비움의 미학</div><p class="arc-desc">아무것도 전시하지 않음으로써 관람객을 전시품으로 만드는 공간.</p><div class="arc-shield"></div></div></div>
        <div class="archive-card"><span class="arc-cat">Architecture</span><div class="arc-body"><h3 class="arc-name">MONOLITH</h3><div class="arc-sub">단일한 거대함</div><p class="arc-desc">이음새 없는 거대한 검은 돌덩어리. 압도적 숭고미.</p><div class="arc-shield"></div></div></div>
      </div>
    </div>
  </div>
  <div class="chatbox-wrap"><div class="chatbox" data-room="archive">
    <div class="cb-body">
      <div class="cb-header"><div class="cb-header-left"><div class="cb-header-logo"><svg viewBox="0 0 24 24"><path d="M 5 19 A 10 10 0 1 1 19 19" stroke-linecap="round"/><circle cx="12" cy="12" r="2" fill="currentColor" stroke="none"/></svg></div><span class="cb-header-name" data-room="archive">Interpret v1</span></div><button class="cb-close" data-room="archive"><svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></button></div>
      <div class="cb-msgs" data-room="archive"><div class="cb-welcome" data-room="archive"><div class="cb-welcome-t">아카이브를 탐색하세요</div><div class="cb-welcome-s">프로젝트의 본질을 깊이 이해합니다.</div><div class="cb-chips"><span class="cb-chip" data-room="archive" data-q="GYEOL 프로젝트의 핵심 철학은?">GYEOL의 본질</span><span class="cb-chip" data-room="archive" data-q="THE VOID는 비즈니스적으로 어떻게 작동하나요?">비움의 비즈니스</span></div></div></div>
      <div class="cb-input"><div class="cb-input-row"><textarea class="cb-ta" data-room="archive" placeholder="아카이브에 대해 질문하세요..." rows="1"></textarea><button class="cb-send" data-room="archive"><svg viewBox="0 0 24 24"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></button></div></div>
    </div>
    <div class="cb-bar" data-room="archive"><div class="cb-model" data-room="archive"><span class="dot" style="background:#666"></span><span class="model-name">Interpret</span><svg class="arr" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></div><span class="cb-ph"><span class="cb-caret"></span>아카이브에 대해 질문하세요...</span></div>
  </div></div>
</div>


<!-- ============================================
     ROOM 04 — MY PAGE (NEW)
     ============================================ -->
<div class="room" id="room-mypage">
  <div class="room-content" data-room="mypage">
    <div class="room-inner">
      <div class="room-label">MY PAGE</div>
      <h1 class="room-title">나의 여정.</h1>

      <!-- Profile + Subscription -->
      <div class="mypage-grid">
        <div class="mypage-card">
          <div class="mc-label">PROFILE</div>
          <div class="mc-value" id="mpName">—</div>
          <div class="mc-sub" id="mpEmail">—</div>
        </div>

        <div class="mypage-card">
          <div class="mc-label">SUBSCRIPTION</div>
          <div class="sub-status">
            <span class="sub-badge free" id="mpBadge">FREE</span>
            <span class="sub-detail" id="mpSubDetail">무료 체험 중</span>
          </div>
          <button class="btn-upgrade" id="btnUpgrade">구독 시작하기</button>
          <button class="btn-manage" id="btnManageSub" style="display:none;">구독 관리</button>
        </div>

        <!-- Payment History -->
        <div class="mypage-card full" id="mpPaymentCard">
          <div class="mc-label">PAYMENT HISTORY</div>
          <div id="mpPaymentBody">
            <div class="pay-empty">결제 내역이 없습니다.</div>
          </div>
        </div>

        <!-- Chat History -->
        <div class="mypage-card full" id="mpChatCard">
          <div class="mc-label">CHAT HISTORY</div>
          <div id="mpChatBody">
            <div class="pay-empty">저장된 대화가 없습니다.</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- ============================================
     LOGIN MODAL
     ============================================ -->
<div class="modal-overlay" id="loginOverlay">
  <div class="login-modal">
    <div class="login-logo">
      <svg viewBox="0 0 24 24">
        <path d="M 5 19 A 10 10 0 1 1 19 19" fill="none" stroke-linecap="round"/>
        <circle cx="12" cy="12" r="2.5" fill="#000" stroke="none"/>
      </svg>
    </div>
    <div class="login-title">Aletheia에 오신 것을 환영합니다</div>
    <div class="login-sub">본질을 탐구하는 여정을 시작하세요.</div>

    <button class="btn-google" id="btnGoogle">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"/>
        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
      </svg>
      Google로 계속하기
    </button>

    <div class="login-terms">
      로그인 시 <a href="#">이용약관</a> 및 <a href="#">개인정보처리방침</a>에 동의합니다.
    </div>
  </div>
</div>


<!-- ============================================
     PRICING MODAL
     ============================================ -->
<div class="modal-overlay" id="pricingOverlay">
  <div class="pricing-modal">
    <button class="login-close" id="pricingClose">
      <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>

    <div class="pricing-title">당신의 본질에 투자하세요.</div>
    <div class="pricing-sub">Aletheia의 서비스를 선택하세요.</div>

    <div class="pricing-grid">
      <!-- Free Plan -->
      <div class="price-card">
        <div class="pc-name">Explorer</div>
        <div class="pc-price">₩0 <span>/ 영구</span></div>
        <div class="pc-desc">Aletheia의 철학을 경험하세요.</div>
        <ul class="pc-features">
          <li>AI 챗봇 기본 대화</li>
          <li>철학 / 방법론 / 아카이브 열람</li>
          <li>일 5회 대화 제한</li>
        </ul>
        <button class="btn-price secondary" disabled>현재 플랜</button>
      </div>

      <!-- Pro Plan -->
      <div class="price-card featured">
        <div class="pc-name">Seeker</div>
        <div class="pc-price">₩29,000 <span>/ 월</span></div>
        <div class="pc-desc">본질을 깊이 탐구하는 풀 서비스.</div>
        <ul class="pc-features">
          <li>Unmask 서비스 무제한 이용</li>
          <li>Interpret 심층 분석</li>
          <li>AI 대화 무제한</li>
          <li>대화 기록 저장 및 내보내기</li>
          <li>1:1 Co-Solve 세션 월 1회</li>
        </ul>
        <button class="btn-price primary" id="btnCheckout">구독 시작 →</button>
      </div>
    </div>

    <!-- One-time option -->
    <div style="text-align:center; margin-top:32px; padding-top:24px; border-top:1px solid rgba(0,0,0,0.05);">
      <div style="font-size:13px; color:#888; font-weight:300; margin-bottom:12px;">단일 서비스가 필요하신가요?</div>
      <button class="btn-manage" id="btnOneTime">1회 Unmask 세션 — ₩49,000</button>
    </div>
  </div>
</div>


<!-- ============================================
     MODEL SELECTOR DROPDOWN (GLOBAL)
     ============================================ -->
<div id="modelMenu">
  <div class="mm-opt" data-model="Core" data-color="#000"><span class="md" style="background:#000"></span>Aletheia Core</div>
  <div class="mm-opt" data-model="Deep" data-color="#444"><span class="md" style="background:#444"></span>Aletheia Deep</div>
  <div class="mm-opt" data-model="Interpret" data-color="#666"><span class="md" style="background:#666"></span>Interpret v1</div>
</div>


<!-- ============================================
     JAVASCRIPT — APPLICATION LOGIC
     ============================================ -->
<script>
(function () {
  'use strict';

  /* ==========================================
     1. STATE & CONSTANTS
     ========================================== */
  var currentRoom = null;

  var models = {
    philosophy: 'Aletheia Core',
    method:     'Aletheia Deep',
    archive:    'Interpret v1'
  };

  var expanded = {};
  var started  = {};
  var menuRoom = null;
  var menu     = document.getElementById('modelMenu');

  var LOGO_SVG = '<svg viewBox="0 0 24 24"><path d="M 5 19 A 10 10 0 1 1 19 19" stroke-linecap="round"/><circle cx="12" cy="12" r="2" fill="currentColor" stroke="none"/></svg>';
  var USER_SVG = '<svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 21v-1a6 6 0 0 1 12 0v1" stroke-linecap="round"/></svg>';

  var MODEL_NAMES = { Core: 'Aletheia Core', Deep: 'Aletheia Deep', Interpret: 'Interpret v1' };


  /* ==========================================
     2. AUTH STATE (Mock → Replace with Firebase)
     ========================================== */

  /**
   * TODO [FIREBASE AUTH]:
   * 1. Initialize Firebase: firebase.initializeApp(config)
   * 2. Replace mockUser with firebase.auth().currentUser
   * 3. Replace mockSignIn() with:
   *    var provider = new firebase.auth.GoogleAuthProvider();
   *    firebase.auth().signInWithPopup(provider)
   * 4. Replace mockSignOut() with firebase.auth().signOut()
   * 5. Listen: firebase.auth().onAuthStateChanged(updateUI)
   */

  var authUser = null; // Current logged-in user (null = logged out)

  // Mock user for demo
  var MOCK_USER = {
    uid:      'mock_001',
    name:     '이민수',
    email:    'minsoo@example.com',
    photo:    null,       // Google profile photo URL
    plan:     'free',     // 'free' | 'seeker'
    joinedAt: '2025-01-15'
  };

  // Mock payment history
  var MOCK_PAYMENTS = [
    // { date: '2025-02-01', item: 'Seeker 구독 (월간)', amount: '₩29,000', status: 'paid' },
    // { date: '2025-01-20', item: '1회 Unmask 세션', amount: '₩49,000', status: 'paid' },
  ];

  // Mock chat history
  var MOCK_CHATS = [
    // { room: 'PHILOSOPHY', preview: 'Less but Better 철학이 뭔가요?', date: '2025-02-08' },
    // { room: 'ARCHIVE', preview: 'GYEOL 프로젝트의 핵심 철학은?', date: '2025-02-07' },
  ];

  function mockSignIn() {
    authUser = MOCK_USER;
    updateAuthUI();
    closeModal('loginOverlay');
  }

  function mockSignOut() {
    authUser = null;
    updateAuthUI();
    closeProfileDropdown();
    // If on mypage, go back to lobby
    if (currentRoom === 'mypage') {
      document.getElementById('room-mypage').classList.remove('open');
      currentRoom = null;
      document.querySelectorAll('.nav-center li').forEach(function (l) { l.classList.remove('active'); });
    }
  }


  /* ==========================================
     3. AUTH UI UPDATE
     ========================================== */
  function updateAuthUI() {
    var btnSignIn   = document.getElementById('btnSignIn');
    var navProfile  = document.getElementById('navProfile');
    var avatar      = document.getElementById('profileAvatar');

    if (authUser) {
      // Logged in
      btnSignIn.style.display = 'none';
      navProfile.classList.add('show');

      // Avatar: photo or initial
      if (authUser.photo) {
        avatar.innerHTML = '<img src="' + authUser.photo + '" alt="">';
      } else {
        avatar.textContent = authUser.name.charAt(0).toUpperCase();
      }

      // Dropdown info
      document.getElementById('pdName').textContent  = authUser.name;
      document.getElementById('pdEmail').textContent = authUser.email;

      var planEl = document.getElementById('pdPlan');
      if (authUser.plan === 'seeker') {
        planEl.textContent = 'SEEKER';
        planEl.classList.add('pro');
        planEl.classList.remove('free');
      } else {
        planEl.textContent = 'FREE';
        planEl.classList.remove('pro');
      }

      // My page data
      updateMyPage();

    } else {
      // Logged out
      btnSignIn.style.display = '';
      navProfile.classList.remove('show');
    }
  }


  /* ==========================================
     4. MY PAGE DATA RENDERING
     ========================================== */
  function updateMyPage() {
    if (!authUser) return;

    document.getElementById('mpName').textContent  = authUser.name;
    document.getElementById('mpEmail').textContent = authUser.email;

    // Subscription
    var badge     = document.getElementById('mpBadge');
    var detail    = document.getElementById('mpSubDetail');
    var btnUp     = document.getElementById('btnUpgrade');
    var btnManage = document.getElementById('btnManageSub');

    if (authUser.plan === 'seeker') {
      badge.textContent = 'SEEKER';
      badge.className   = 'sub-badge pro';
      detail.textContent = '월간 구독 활성';
      btnUp.style.display     = 'none';
      btnManage.style.display = '';
    } else {
      badge.textContent = 'FREE';
      badge.className   = 'sub-badge free';
      detail.textContent = '무료 체험 중';
      btnUp.style.display     = '';
      btnManage.style.display = 'none';
    }

    // Payment history
    renderPayments();

    // Chat history
    renderChatHistory();
  }

  function renderPayments() {
    var body = document.getElementById('mpPaymentBody');
    /**
     * TODO [FIRESTORE]: Replace MOCK_PAYMENTS with:
     * firebase.firestore().collection('users').doc(authUser.uid)
     *   .collection('payments').orderBy('date','desc').get()
     */
    var payments = MOCK_PAYMENTS;

    if (!payments.length) {
      body.innerHTML = '<div class="pay-empty">결제 내역이 없습니다.</div>';
      return;
    }

    var html = '<table class="pay-table"><thead><tr><th>DATE</th><th>ITEM</th><th>AMOUNT</th><th>STATUS</th></tr></thead><tbody>';
    payments.forEach(function (p) {
      html += '<tr><td>' + p.date + '</td><td>' + p.item + '</td><td>' + p.amount + '</td><td><span class="pay-status ' + p.status + '">' + (p.status === 'paid' ? '완료' : '대기') + '</span></td></tr>';
    });
    html += '</tbody></table>';
    body.innerHTML = html;
  }

  function renderChatHistory() {
    var body = document.getElementById('mpChatBody');
    /**
     * TODO [FIRESTORE]: Replace MOCK_CHATS with:
     * firebase.firestore().collection('users').doc(authUser.uid)
     *   .collection('chats').orderBy('date','desc').get()
     */
    var chats = MOCK_CHATS;

    if (!chats.length) {
      body.innerHTML = '<div class="pay-empty">저장된 대화가 없습니다.</div>';
      return;
    }

    var html = '';
    chats.forEach(function (c) {
      html += '<div class="chat-history-item"><div><div class="chi-room">' + c.room + '</div><div class="chi-preview">' + c.preview + '</div></div><div class="chi-date">' + c.date + '</div></div>';
    });
    body.innerHTML = html;
  }


  /* ==========================================
     5. PAYMENT / STRIPE (Mock → Replace)
     ========================================== */

  /**
   * TODO [STRIPE]:
   * 1. Backend: Create Stripe Checkout Session
   *    POST /api/create-checkout-session { priceId, userId }
   * 2. Frontend:
   *    var stripe = Stripe('pk_live_...');
   *    stripe.redirectToCheckout({ sessionId: response.sessionId });
   * 3. Webhook: /api/stripe-webhook
   *    - checkout.session.completed → update Firestore user.plan
   *    - invoice.payment_succeeded → log to payments collection
   *
   * Price IDs to create in Stripe Dashboard:
   *    - Seeker Monthly: price_seeker_monthly (₩29,000/월)
   *    - Unmask One-Time: price_unmask_single (₩49,000)
   */

  function handleCheckout(type) {
    if (!authUser) {
      openModal('loginOverlay');
      return;
    }

    // TODO: Replace with real Stripe checkout
    console.log('[STRIPE] Checkout type:', type);
    alert('결제 연동 준비 중입니다.\n\nStripe 연결 후 활성화됩니다.\n\n유형: ' + type);
  }


  /* ==========================================
     6. MODAL MANAGEMENT
     ========================================== */
  function openModal(id) {
    var el = document.getElementById(id);
    el.style.display = 'flex';
    // Force reflow for transition
    el.offsetHeight;
    el.classList.add('show');
  }

  function closeModal(id) {
    var el = document.getElementById(id);
    el.classList.remove('show');
    setTimeout(function () { el.style.display = 'none'; }, 350);
  }

  // Login modal
  document.getElementById('btnSignIn').addEventListener('click', function () {
    openModal('loginOverlay');
  });

  document.getElementById('loginOverlay').addEventListener('click', function (e) {
    if (e.target === this) closeModal('loginOverlay');
  });

  document.getElementById('btnGoogle').addEventListener('click', function () {
    /**
     * TODO [FIREBASE AUTH]: Replace mockSignIn() with:
     * var provider = new firebase.auth.GoogleAuthProvider();
     * firebase.auth().signInWithPopup(provider).then(function(result) {
     *   authUser = {
     *     uid:   result.user.uid,
     *     name:  result.user.displayName,
     *     email: result.user.email,
     *     photo: result.user.photoURL,
     *     plan:  'free'  // fetch from Firestore
     *   };
     *   updateAuthUI();
     *   closeModal('loginOverlay');
     * });
     */
    mockSignIn();
  });

  // Pricing modal
  document.getElementById('pricingClose').addEventListener('click', function () {
    closeModal('pricingOverlay');
  });

  document.getElementById('pricingOverlay').addEventListener('click', function (e) {
    if (e.target === this) closeModal('pricingOverlay');
  });

  document.getElementById('btnCheckout').addEventListener('click', function () {
    handleCheckout('seeker_monthly');
  });

  document.getElementById('btnOneTime').addEventListener('click', function () {
    handleCheckout('unmask_single');
  });

  document.getElementById('btnUpgrade').addEventListener('click', function () {
    openModal('pricingOverlay');
  });

  document.getElementById('btnManageSub').addEventListener('click', function () {
    /**
     * TODO [STRIPE PORTAL]:
     * Redirect to Stripe Customer Portal:
     * fetch('/api/create-portal-session', { userId: authUser.uid })
     *   .then(res => window.location.href = res.url)
     */
    alert('Stripe Customer Portal 연동 후 활성화됩니다.');
  });


  /* ==========================================
     7. PROFILE DROPDOWN
     ========================================== */
  var dropdown = document.getElementById('profileDropdown');

  document.getElementById('profileAvatar').addEventListener('click', function (e) {
    e.stopPropagation();
    dropdown.classList.toggle('show');
  });

  document.addEventListener('click', function (e) {
    if (!e.target.closest('.nav-profile')) {
      closeProfileDropdown();
    }
  });

  function closeProfileDropdown() {
    dropdown.classList.remove('show');
  }

  // Dropdown items
  document.getElementById('pdMypage').addEventListener('click', function () {
    closeProfileDropdown();
    openRoom('mypage');
  });

  document.getElementById('pdPricing').addEventListener('click', function () {
    closeProfileDropdown();
    openModal('pricingOverlay');
  });

  document.getElementById('pdHistory').addEventListener('click', function () {
    closeProfileDropdown();
    openRoom('mypage');
    // Scroll to payment section
    setTimeout(function () {
      var card = document.getElementById('mpPaymentCard');
      if (card) card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }, 400);
  });

  document.getElementById('pdLogout').addEventListener('click', function () {
    /**
     * TODO [FIREBASE AUTH]: Replace mockSignOut() with:
     * firebase.auth().signOut().then(function() {
     *   mockSignOut();
     * });
     */
    mockSignOut();
  });

  // Escape closes modals
  window.addEventListener('keydown', function (e) {
    if (e.key !== 'Escape') return;
    if (document.getElementById('loginOverlay').classList.contains('show')) {
      closeModal('loginOverlay');
      return;
    }
    if (document.getElementById('pricingOverlay').classList.contains('show')) {
      closeModal('pricingOverlay');
      return;
    }
  });


  /* ==========================================
     7b. MOBILE VIEW TOGGLE
     ========================================== */
  var mobileToggleBtn = document.getElementById('btnMobileToggle');
  var mobileToggleLabel = mobileToggleBtn.querySelector('.mobile-toggle-label');
  var isMobileMode = false;

  mobileToggleBtn.addEventListener('click', function () {
    isMobileMode = !isMobileMode;
    document.body.classList.toggle('mobile-mode', isMobileMode);
    mobileToggleBtn.classList.toggle('active', isMobileMode);
    mobileToggleLabel.textContent = isMobileMode ? 'Desktop' : 'Mobile';

    // Update the phone/desktop icon
    if (isMobileMode) {
      mobileToggleBtn.querySelector('svg').innerHTML = '<rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/>';
    } else {
      mobileToggleBtn.querySelector('svg').innerHTML = '<rect x="7" y="2" width="10" height="20" rx="2"/><line x1="10" y1="18" x2="14" y2="18"/>';
    }
  });


  /* ==========================================
     8. HERO ANIMATION
     ========================================== */
  setTimeout(function () { document.getElementById('heroSub').classList.add('show'); }, 800);
  setTimeout(function () { document.getElementById('heroMain').classList.add('show'); }, 1800);


  /* ==========================================
     9. NAVIGATION — ROOM SWITCHING
     ========================================== */
  function openRoom(room) {
    // Close previous room
    if (currentRoom) {
      closeChat(currentRoom);
      document.getElementById('room-' + currentRoom).classList.remove('open');
    }

    // Clear active nav
    document.querySelectorAll('.nav-center li').forEach(function (l) { l.classList.remove('active'); });

    // Activate nav link if it exists
    var navItem = document.querySelector('.nav-center li[data-room="' + room + '"]');
    if (navItem) navItem.classList.add('active');

    currentRoom = room;
    document.getElementById('room-' + room).classList.add('open');
  }

  document.getElementById('logoBtn').addEventListener('click', function () {
    if (currentRoom) {
      closeChat(currentRoom);
      document.getElementById('room-' + currentRoom).classList.remove('open');
      currentRoom = null;
    }
    document.querySelectorAll('.nav-center li').forEach(function (l) { l.classList.remove('active'); });
  });

  document.querySelectorAll('.nav-center li').forEach(function (li) {
    li.addEventListener('click', function () {
      openRoom(li.getAttribute('data-room'));
    });
  });


  /* ==========================================
     10. CHATBOX — OPEN / CLOSE
     ========================================== */
  document.querySelectorAll('.cb-bar').forEach(function (bar) {
    bar.addEventListener('click', function (e) {
      if (e.target.closest('.cb-model')) return;
      openChat(bar.getAttribute('data-room'));
    });
  });

  document.querySelectorAll('.cb-close').forEach(function (btn) {
    btn.addEventListener('click', function () {
      closeChat(btn.getAttribute('data-room'));
    });
  });

  // Escape closes chatbox (after modal check above)
  window.addEventListener('keydown', function (e) {
    if (e.key !== 'Escape') return;
    var open = document.querySelector('.room.open .chatbox.expanded');
    if (open) closeChat(open.getAttribute('data-room'));
  });

  function openChat(room) {
    expanded[room] = true;
    var box = document.querySelector('.chatbox[data-room="' + room + '"]');
    box.classList.add('expanded');
    document.querySelector('.room-content[data-room="' + room + '"]').classList.add('blurred');
    hideMenu();
    setTimeout(function () { var ta = box.querySelector('.cb-ta'); if (ta) ta.focus(); }, 350);
  }

  function closeChat(room) {
    expanded[room] = false;
    var box = document.querySelector('.chatbox[data-room="' + room + '"]');
    if (box) box.classList.remove('expanded');
    var rc = document.querySelector('.room-content[data-room="' + room + '"]');
    if (rc) rc.classList.remove('blurred');
    hideMenu();
  }


  /* ==========================================
     11. MODEL SELECTOR MENU
     ========================================== */
  document.querySelectorAll('.cb-model').forEach(function (badge) {
    badge.addEventListener('click', function (e) {
      e.stopPropagation();
      var room = badge.getAttribute('data-room');
      if (menu.classList.contains('show') && menuRoom === room) { hideMenu(); return; }
      menuRoom = room;
      var rect = badge.getBoundingClientRect();
      menu.style.left = rect.left + 'px';
      menu.style.bottom = (window.innerHeight - rect.top + 8) + 'px';
      var cur = badge.querySelector('.model-name').textContent;
      menu.querySelectorAll('.mm-opt').forEach(function (o) { o.classList.toggle('active', o.getAttribute('data-model') === cur); });
      menu.classList.add('show');
    });
  });

  menu.addEventListener('click', function (e) {
    var opt = e.target.closest('.mm-opt');
    if (!opt || !menuRoom) return;
    e.stopPropagation();
    var room = menuRoom, model = opt.getAttribute('data-model'), color = opt.getAttribute('data-color');
    var badge = document.querySelector('.cb-model[data-room="' + room + '"]');
    badge.querySelector('.model-name').textContent = model;
    badge.querySelector('.dot').style.background = color;
    var hn = document.querySelector('.cb-header-name[data-room="' + room + '"]');
    if (hn) hn.textContent = MODEL_NAMES[model] || model;
    models[room] = MODEL_NAMES[model] || model;
    hideMenu();
  });

  document.addEventListener('click', function (e) {
    if (!e.target.closest('.cb-model') && !e.target.closest('#modelMenu')) hideMenu();
  });

  function hideMenu() { menu.classList.remove('show'); menuRoom = null; }


  /* ==========================================
     12. CHAT — SEND / RECEIVE
     ========================================== */
  function sendMsg(room, text) {
    if (!text || !text.trim()) return;
    text = text.trim();
    if (!expanded[room]) openChat(room);
    var msgs = document.querySelector('.cb-msgs[data-room="' + room + '"]');
    var wel  = document.querySelector('.cb-welcome[data-room="' + room + '"]');
    if (!started[room]) { started[room] = true; wel.classList.add('hidden'); }
    addMsg(msgs, 'user', text, room);
    var ta = document.querySelector('.chatbox[data-room="' + room + '"] .cb-ta');
    ta.value = ''; ta.style.height = 'auto';
    document.querySelector('.cb-send[data-room="' + room + '"]').classList.remove('ready');
    var typ = addTyping(msgs, room);

    /**
     * TODO [FIRESTORE CHAT SAVE]:
     * if (authUser) {
     *   firebase.firestore().collection('users').doc(authUser.uid)
     *     .collection('chats').add({
     *       room: room, userMsg: text,
     *       aiMsg: response, model: models[room],
     *       timestamp: firebase.firestore.FieldValue.serverTimestamp()
     *     });
     * }
     */

    setTimeout(function () { typ.remove(); addMsg(msgs, 'ai', respond(room, text), room); }, 800 + Math.random() * 1000);
  }

  function addMsg(area, role, text, room) {
    var d = document.createElement('div'); d.className = 'msg';
    d.innerHTML = '<div class="msg-ava ' + role + '">' + (role === 'ai' ? LOGO_SVG : USER_SVG) + '</div><div class="msg-body"><div class="msg-role">' + (role === 'ai' ? models[room].toUpperCase() : 'YOU') + '</div><div class="msg-text">' + text.replace(/\n/g, '<br>') + '</div></div>';
    area.appendChild(d); area.scrollTop = area.scrollHeight;
  }

  function addTyping(area, room) {
    var d = document.createElement('div'); d.className = 'msg';
    d.innerHTML = '<div class="msg-ava ai">' + LOGO_SVG + '</div><div class="msg-body"><div class="msg-role">' + models[room].toUpperCase() + '</div><div class="typing"><span></span><span></span><span></span></div></div>';
    area.appendChild(d); area.scrollTop = area.scrollHeight; return d;
  }


  /* ==========================================
     13. CHAT — INPUT HANDLERS
     ========================================== */
  document.querySelectorAll('.cb-ta').forEach(function (ta) {
    ta.addEventListener('input', function () {
      ta.style.height = 'auto';
      ta.style.height = Math.min(ta.scrollHeight, 100) + 'px';
      var btn = document.querySelector('.cb-send[data-room="' + ta.getAttribute('data-room') + '"]');
      btn.classList.toggle('ready', ta.value.trim().length > 0);
    });
    ta.addEventListener('keydown', function (e) {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMsg(ta.getAttribute('data-room'), ta.value); }
    });
  });

  document.querySelectorAll('.cb-send').forEach(function (btn) {
    btn.addEventListener('click', function () {
      var ta = document.querySelector('.chatbox[data-room="' + btn.getAttribute('data-room') + '"] .cb-ta');
      sendMsg(btn.getAttribute('data-room'), ta.value);
    });
  });

  document.querySelectorAll('.cb-chip').forEach(function (chip) {
    chip.addEventListener('click', function () { sendMsg(chip.getAttribute('data-room'), chip.getAttribute('data-q')); });
  });


  /* ==========================================
     14. CHAT — AI RESPONSES (Mock)
     ========================================== */
  /**
   * TODO [API]: Replace with real AI API calls
   * fetch('/api/chat', { method:'POST', body: JSON.stringify({ room, message, model }) })
   *   .then(res => res.json()).then(data => addMsg(msgs, 'ai', data.reply, room))
   */
  function respond(room, input) {
    var l = input.toLowerCase();
    if (room === 'philosophy') {
      if (l.indexOf('less') >= 0 || l.indexOf('better') >= 0 || l.indexOf('덜') >= 0) return "\"Weniger, aber besser.\" Dieter Rams의 이 문장은 단순한 디자인 원칙이 아닙니다.\n\n이것은 삶의 태도입니다. 무엇을 추가할지가 아니라 무엇을 제거할지를 먼저 묻는 것.\n\n남은 것의 무게와 밀도가 본질의 증거가 됩니다.";
      if (l.indexOf('컨설팅') >= 0 || l.indexOf('차이') >= 0) return "기존 컨설팅은 '트렌드'를 분석하고 '전략'을 제시합니다. 우리는 그 반대입니다.\n\nAletheia는 외부 데이터가 아니라 당신 내면의 경험에서 출발합니다.\n\n그래서 우리의 결과물은 전략서가 아니라 — 당신만의 물성입니다.";
      if (l.indexOf('물성') >= 0) return "물성(物性)은 사물이 가진 고유한 성질입니다.\n\n나무는 시간이 지나면 색이 변하고, 가죽은 사용할수록 부드러워집니다.\n\n우리는 당신의 경험도 하나의 재료로 봅니다.";
      return "Aletheia(ἀλήθεια)는 '비은폐' — 감춰진 것을 드러냄을 뜻합니다.\n\n우리는 답을 만들어주지 않습니다. 올바른 질문의 구조를 함께 만들어가는 것이 우리의 역할입니다.";
    }
    if (room === 'method') {
      if (l.indexOf('unmask') >= 0 || l.indexOf('언마스크') >= 0) return "Unmask는 사회가 씌운 페르소나를 벗겨내는 과정입니다.\n\n감각의 파편을 수집하고, 패턴을 발견합니다.";
      if (l.indexOf('co-solve') >= 0 || l.indexOf('함께') >= 0) return "우리는 문제를 '해결'하지 않습니다.\n\nCo-Solve는 당신과 나란히 앉아 같은 방향을 바라보며 탐구하는 과정입니다.";
      return "네 단계는 순서가 있지만 반드시 순차적이지 않습니다.\n\n본질은 직선이 아니라 나선형으로 드러나니까요.";
    }
    if (room === 'archive') {
      if (l.indexOf('gyeol') >= 0 || l.indexOf('결') >= 0) return "GYEOL(결)은 '침묵의 서사'를 다루는 베이커리입니다.\n\n핵심 질문: '빵집에서 가장 중요한 소리는?'\n\n답은 침묵이었습니다.";
      if (l.indexOf('void') >= 0 || l.indexOf('비움') >= 0) return "THE VOID는 비즈니스적 역설을 실험한 프로젝트입니다.\n\n관람객이 빈 공간에 들어서면 그들 자신이 전시품이 됩니다.";
      return "각 아카이브는 실제 프로젝트이면서 동시에 사고 실험입니다.\n\n어떤 프로젝트에 대해 더 깊이 알고 싶으신가요?";
    }
    return "흥미로운 질문입니다. 조금 더 이야기해주시면 함께 탐구해볼 수 있습니다.";
  }


  /* ==========================================
     15. MOBILE DRAWER
     ========================================== */
  var drawerOverlay = document.getElementById('drawerOverlay');
  var mobileDrawer  = document.getElementById('mobileDrawer');
  var hamburgerBtn  = document.getElementById('hamburgerBtn');

  function openDrawer() {
    drawerOverlay.style.display = 'block';
    drawerOverlay.offsetHeight; // force reflow
    drawerOverlay.classList.add('show');
    mobileDrawer.classList.add('open');
    hamburgerBtn.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeDrawer() {
    drawerOverlay.classList.remove('show');
    mobileDrawer.classList.remove('open');
    hamburgerBtn.classList.remove('active');
    setTimeout(function () {
      drawerOverlay.style.display = 'none';
      document.body.style.overflow = '';
    }, 400);
  }

  hamburgerBtn.addEventListener('click', function () {
    if (mobileDrawer.classList.contains('open')) closeDrawer();
    else openDrawer();
  });

  drawerOverlay.addEventListener('click', closeDrawer);
  document.getElementById('drawerClose').addEventListener('click', closeDrawer);

  // Drawer navigation items
  document.querySelectorAll('.drawer-nav-item').forEach(function (item) {
    item.addEventListener('click', function () {
      var room = item.getAttribute('data-room');
      closeDrawer();
      setTimeout(function () { openRoom(room); }, 200);

      // Mark active
      document.querySelectorAll('.drawer-nav-item').forEach(function (i) { i.classList.remove('active'); });
      item.classList.add('active');
    });
  });

  // Drawer sign in
  document.getElementById('drawerSignIn').addEventListener('click', function () {
    closeDrawer();
    setTimeout(function () { openModal('loginOverlay'); }, 250);
  });

  // Drawer account actions
  document.getElementById('drawerMypage').addEventListener('click', function () {
    closeDrawer();
    setTimeout(function () { openRoom('mypage'); }, 200);
  });

  document.getElementById('drawerPricing').addEventListener('click', function () {
    closeDrawer();
    setTimeout(function () { openModal('pricingOverlay'); }, 250);
  });

  document.getElementById('drawerPayHistory').addEventListener('click', function () {
    closeDrawer();
    setTimeout(function () {
      openRoom('mypage');
      setTimeout(function () {
        var card = document.getElementById('mpPaymentCard');
        if (card) card.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }, 400);
    }, 200);
  });

  document.getElementById('drawerLogout').addEventListener('click', function () {
    closeDrawer();
    setTimeout(function () { mockSignOut(); }, 200);
  });


  /* ==========================================
     16. DRAWER AUTH STATE SYNC
     ========================================== */
  // Patch updateAuthUI to also update mobile drawer
  var _origUpdateAuthUI = updateAuthUI;

  updateAuthUI = function () {
    _origUpdateAuthUI();
    updateDrawerAuth();
  };

  function updateDrawerAuth() {
    var drawerUser    = document.getElementById('drawerUser');
    var drawerAuth    = document.getElementById('drawerAuth');
    var drawerAccount = document.getElementById('drawerAccount');

    if (authUser) {
      drawerAuth.style.display    = 'none';
      drawerUser.classList.add('show');
      drawerAccount.style.display = '';

      // Avatar
      var av = document.getElementById('drawerAvatar');
      if (authUser.photo) {
        av.innerHTML = '<img src="' + authUser.photo + '" alt="">';
      } else {
        av.textContent = authUser.name.charAt(0).toUpperCase();
      }

      document.getElementById('drawerName').textContent  = authUser.name;
      document.getElementById('drawerEmail').textContent = authUser.email;

      var badge = document.getElementById('drawerBadge');
      if (authUser.plan === 'seeker') {
        badge.textContent = 'SEEKER';
        badge.classList.add('pro');
      } else {
        badge.textContent = 'FREE';
        badge.classList.remove('pro');
      }
    } else {
      drawerAuth.style.display    = '';
      drawerUser.classList.remove('show');
      drawerAccount.style.display = 'none';
    }
  }

})();
</script>


<!-- ============================================
     THREE.JS — 3D PARTICLE BACKGROUND
     ============================================ -->
<script>
(function () {
  'use strict';
  try {
    var container = document.getElementById('canvas-container');
    if (!container || typeof THREE === 'undefined') return;

    var scene = new THREE.Scene();
    scene.background = new THREE.Color(0xffffff);
    scene.fog = new THREE.FogExp2(0xffffff, 0.002);

    var camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
    camera.position.z = 180;

    var renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(innerWidth, innerHeight);
    renderer.setPixelRatio(devicePixelRatio);
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.outputEncoding = THREE.sRGBEncoding;
    container.appendChild(renderer.domElement);

    function createParticleTexture() {
      var s = 128, cv = document.createElement('canvas'); cv.width = s; cv.height = s;
      var c = cv.getContext('2d'), g = c.createRadialGradient(s/2,s/2,0,s/2,s/2,s/2);
      g.addColorStop(0,'rgba(0,0,0,1)'); g.addColorStop(0.2,'rgba(10,10,10,0.8)');
      g.addColorStop(0.5,'rgba(30,30,30,0.2)'); g.addColorStop(1,'rgba(0,0,0,0)');
      c.fillStyle = g; c.fillRect(0,0,s,s);
      return new THREE.CanvasTexture(cv);
    }

    var coreGroup = new THREE.Group(); scene.add(coreGroup);
    coreGroup.add(new THREE.Mesh(new THREE.IcosahedronGeometry(3.8,5), new THREE.MeshBasicMaterial({color:0x000000,wireframe:true,transparent:true,opacity:0.3})));
    coreGroup.add(new THREE.Mesh(new THREE.IcosahedronGeometry(5,2), new THREE.MeshBasicMaterial({color:0x555555,wireframe:true,transparent:true,opacity:0.1})));

    var PARTICLE_COUNT = 28000, particleGeometry = new THREE.BufferGeometry();
    var positions = new Float32Array(PARTICLE_COUNT*3), originalPositions = [], randomness = [];
    for (var i=0;i<PARTICLE_COUNT*3;i+=3) {
      var R=20+85*Math.pow(Math.random(),1.2),th=Math.random()*Math.PI*2,ph=Math.acos(2*Math.random()-1);
      var x=R*Math.sin(ph)*Math.cos(th),y=R*Math.sin(ph)*Math.sin(th),z=R*Math.cos(ph);
      positions[i]=x;positions[i+1]=y;positions[i+2]=z;
      originalPositions.push({x:x,y:y,z:z});
      randomness.push({speed:0.1+Math.random()*0.4,phase:Math.random()*Math.PI*2,amp:1.5+Math.random()*3});
    }
    particleGeometry.setAttribute('position',new THREE.BufferAttribute(positions,3));
    var particleMesh = new THREE.Points(particleGeometry,new THREE.PointsMaterial({size:1.2,color:0x111111,map:createParticleTexture(),transparent:true,opacity:0.85,sizeAttenuation:true,depthWrite:false}));
    scene.add(particleMesh);

    scene.add(new THREE.AmbientLight(0xffffff,1.5));
    var dl = new THREE.DirectionalLight(0xffffff,2); dl.position.set(50,50,50); scene.add(dl);

    var composer = new THREE.EffectComposer(renderer);
    composer.addPass(new THREE.RenderPass(scene,camera));
    composer.addPass(new THREE.UnrealBloomPass(new THREE.Vector2(innerWidth,innerHeight),0.1,0.5,0.98));

    var time=0,mouseX=0,mouseY=0;
    document.addEventListener('mousemove',function(e){mouseX=(e.clientX-innerWidth/2)*0.05;mouseY=(e.clientY-innerHeight/2)*0.05});

    (function animate(){
      requestAnimationFrame(animate); time+=0.0008;
      var pos=particleGeometry.attributes.position.array;
      for(var i=0;i<PARTICLE_COUNT;i++){var i3=i*3,o=originalPositions[i],rr=randomness[i],w=Math.sin(time*rr.speed+rr.phase)*rr.amp;
        pos[i3]=o.x+Math.cos(time*0.5+rr.phase)*1.5;pos[i3+1]=o.y+Math.sin(time*0.3+rr.phase)*1.5+w;pos[i3+2]=o.z+w;}
      particleGeometry.attributes.position.needsUpdate=true;
      particleMesh.rotation.y+=0.0001+mouseX*0.00005;particleMesh.rotation.x+=mouseY*0.00005;
      coreGroup.rotation.y-=0.0005;coreGroup.rotation.x+=0.0002;composer.render();
    })();

    addEventListener('resize',function(){camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);composer.setSize(innerWidth,innerHeight)});
  } catch(e) { console.log('Three.js skipped:',e); }
})();
</script>

</body>
</html>
